<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details</title>
    <link rel="stylesheet" href="./css/global.css">
    <link rel="stylesheet" href="./css/header.css">
    <link rel="stylesheet" href="./css/product-page.css">
    <link rel="stylesheet" href="./css/footer.css">
    <link rel="stylesheet" href="./css/home-page.css">
</head>

<body>
    <header>
        <a href="index.html" class="header-link">
            <img src="./assets/images/logos/logo.jpg" alt="Mediocre Shop CA Logo" class="header-image">
            <h1 class="header-title">Mediocre Shop CA</h1>
        </a>
        <div class="cart-icon">
            <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none"
                viewBox="0 0 24 24">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M5 4h1.5L9 16m0 0h8m-8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm-8.5-3h9.25L19 7H7.312" />
            </svg>
            <span>0</span>
        </div>
    </header>

    <main>
        
        <div class="product-page">
            <div class="product-images">
                <img id="main-img" src="" alt="Product Main Image">
                <div class="image-gallery" id="gallery"></div>
            </div>

            <div class="product-details">
                <h2 id="product-name"></h2>
                <div class="price-section">
                    <span class="price" id="product-price"></span>
                </div>
                <div class="description" id="product-description"></div>
                <div class="technical-specs">
                    <h3>Technical Specifications</h3>
                    <ul id="specifications-list"></ul>
                </div>
                <div class="purchase-section">
                    <a id="add-to-cart-link" href="" class="add-to-cart-button">Add To Cart</a>
                    <a id="buy-now-link" href="" class="buy-now-button">Buy Now</a>
                    <p id="stock-status"></p>
                </div>
                <p class="sold-by" id="sold-by"></p>
            </div>
        </div>
        <div class="cart-container">
            <section class="cart-tab">
                <h1>Shopping Cart 
                    <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none"
                        viewBox="0 2 24 24">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M5 4h1.5L9 16m0 0h8m-8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm-8.5-3h9.25L19 7H7.312" />
                    </svg>
                    <a href="./cart.html" class="cart-page-link">View On Cart Page</a>

                </h1>
                <div class="list-cart">
                </div>
                <div class="cart-total-container">
                    <span class="title">Total Amount To Pay</span>
                    <span class="to-pay">$0.00</span>
                </div>
                <div class="btn">
                    <button class="close">Close</button>
                    <button onclick="location.href='./cart.html'" class="checkout">Check Out</button>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <p class="footer-text">&copy; 2024 Mediocre Shop CA</p>
    </footer>

    <script src="./js/global.js"></script>
    <script src="./js/helper.js"></script>
    <script>
        function getProductIdFromUrl() {
            const params = new URLSearchParams(window.location.search);
            return params.get('id');
        }

        function loadProductData() {
            const productId = getProductIdFromUrl();
            if (!productId) return;

            const product = laptops[Object.keys(laptops).find(key => laptops[key].id === productId)];
            if (!product) return;

            document.title = product.title;
            const mainImg = document.getElementById('main-img');
            mainImg.src = product.img1;
            mainImg.alt = product.name;

            const gallery = document.getElementById('gallery');
            [product.img1, product.img2, product.img3, product.img4].forEach(imgSrc => {
                const img = document.createElement('img');
                img.src = imgSrc;
                img.alt = `${product.name} thumbnail`;
                img.classList.add('gallery-image');
                img.addEventListener('click', () => {
                    mainImg.src = imgSrc;
                });
                gallery.appendChild(img);
            });

            document.getElementById('product-name').textContent = product.name;
            if (product.originalPrice) {
                document.getElementById('product-price').innerHTML = `<span class="original-price">${product.originalPrice}</span>
                           <span class="new-price">${product.price}</span>`;
            } else {
                document.getElementById('product-price').textContent = product.price;
            }
            document.getElementById('product-description').textContent = product.description;

            const specList = document.getElementById('specifications-list');
            product.specifications.forEach(spec => {
                const li = document.createElement('li');
                li.textContent = spec;
                specList.appendChild(li);
            });
            const addToCartButton = document.getElementById('add-to-cart-link');
            addToCartButton.textContent = "Add to Cart";
            addToCartButton.addEventListener('click', (event) => {
                event.preventDefault();
                handleAddToShoppingCart(`${product.id}`)
                addProductToCartContainerComponent();
                updatecartContainerToPaySpan(GetFloatValue(laptops[product.id].price), 'plus')
                cartContainerToPaySpan.innerHTML = CURRENT_TOTAL;
                alert(`${product.name} added to cart`)
            })
            const buyNowLink = document.getElementById('buy-now-link');
            buyNowLink.href = product.buyNowLink;
            document.getElementById('stock-status').textContent = product.stockStatus;
            document.getElementById('sold-by').textContent = `Sold by ${product.soldBy}`;
        }

        window.onload = function() {
            loadProductData();
            if(localStorage.getItem('cart')) {
                CART_ITEMS = JSON.parse(localStorage.getItem('cart'));
                addProductToCartContainerComponent();
            }
            if(localStorage.getItem('cart-total')) {
                CURRENT_TOTAL = JSON.parse(localStorage.getItem('cart-total'));
                updatecartContainerToPaySpan();
            }
        };;

    </script>
</body>

</html>